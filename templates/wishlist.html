{% extends "base.html" %}
{% block content %}
    <h2>ğŸŒ  å…±äº«æ„¿æœ›æ¸…å•</h2>
    <p>æ·»åŠ æ‚¨å’Œ <strong>{{ current_user.partner.username if current_user.partner else 'TA' }}</strong> æƒ³ä¸€èµ·å®Œæˆçš„äº‹æƒ…ï¼</p>

    <!-- æ·»åŠ æ–°æ„¿æœ›çš„è¡¨å• -->
    <form action="{{ url_for('add_wish') }}" method="POST" class="wishlist-form">
        <div class="form-group" style="flex-grow: 1; margin-bottom: 0;">
            <input type="text" id="content" name="content" placeholder="ä¾‹å¦‚: ä¸€èµ·å»æ—…è¡Œ..." required>
        </div>
        <button type="submit" class="btn">æ·»åŠ æ„¿æœ›</button>
    </form>
    
    <hr>

    <!-- æ¸…å•å®¹å™¨ -->
    <div class="wishlist-container">
        
        <!-- å¾…åŠåˆ— -->
        <div class="wishlist-column">
            <h3>ğŸ“ å¾…åŠæ¸…å•</h3>
            <ul class="wishlist">
                {% for item in todo_wishes %}
                    <li class="wishlist-item">
                        <div class="wishlist-item-content">
                            <!-- 
                              "å®Œæˆ" æŒ‰é’®
                              è¿™æ˜¯ä¸€ä¸ªè¡¨å•, å®ƒ POST åˆ° 'toggle_wish' è·¯ç”±
                            -->
                            <form action="{{ url_for('toggle_wish', item_id=item.id) }}" method="POST" style="margin: 0;">
                                <button type="submit" style="background: none; border: none; cursor: pointer; font-size: 1.5em; margin-right: 5px;" title="æ ‡è®°ä¸ºå·²å®Œæˆ">âœ…</button>
                            </form>
                            <span>{{ item.content }}</span>
                            <!-- ä½œè€…æ ‡ç­¾ -->
                            {% if item.author_id == current_user.id %}
                                <span class="author-tag author-me">æˆ‘</span>
                            {% else %}
                                <span class="author-tag author-partner">TA</span>
                            {% endif %}
                        </div>
                        <div class="actions">
                            <!-- åªæœ‰ä½œè€…æ‰èƒ½åˆ é™¤ -->
                            {% if item.author_id == current_user.id %}
                                <form action="{{ url_for('delete_wish', item_id=item.id) }}" method="POST" onsubmit="return confirm('æ‚¨ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ„¿æœ›å—ï¼Ÿ');">
                                    <button type="submit" class="btn btn-delete-sm" title="åˆ é™¤">âŒ</button>
                                </form>
                            {% endif %}
                        </div>
                    </li>
                {% else %}
                    <li>è¿˜æ²¡æœ‰å¾…åŠçš„æ„¿æœ›ã€‚</li>
                {% endfor %}
            </ul>
        </div>
        
        <!-- å·²å®Œæˆåˆ— -->
        <div class="wishlist-column">
            <h3>ğŸ‰ å·²å®Œæˆï¼</h3>
            <ul class="wishlist">
                {% for item in done_wishes %}
                    <li class="wishlist-item completed">
                        <div class="wishlist-item-content">
                            <!-- 
                              "æ’¤é”€" æŒ‰é’®
                              å®ƒå’Œ "å®Œæˆ" æŒ‰é’®æŒ‡å‘åŒä¸€ä¸ª 'toggle_wish' è·¯ç”±
                            -->
                            <form action="{{ url_for('toggle_wish', item_id=item.id) }}" method="POST" style="margin: 0;">
                                <button type="submit" style="background: none; border: none; cursor: pointer; font-size: 1.5em; margin-right: 5px;" title="æ ‡è®°ä¸ºæœªå®Œæˆ">âª</button>
                            </form>
                            <span>{{ item.content }}</span>
                            <!-- ä½œè€…æ ‡ç­¾ -->
                            {% if item.author_id == current_user.id %}
                                <span class="author-tag author-me">æˆ‘</span>
                            {% else %}
                                <span class="author-tag author-partner">TA</span>
                            {% endif %}
                        </div>
                        <div class="actions">
                            <!-- åªæœ‰ä½œè€…æ‰èƒ½åˆ é™¤ -->
                            {% if item.author_id == current_user.id %}
                                <form action="{{ url_for('delete_wish', item_id=item.id) }}" method="POST" onsubmit="return confirm('æ‚¨ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ„¿æœ›å—ï¼Ÿ');">
                                    <button type="submit" class="btn btn-delete-sm" title="åˆ é™¤">âŒ</button>
                                </form>
                            {% endif %}
                        </div>
                    </li>
                {% else %}
                    <li>è¿˜æ²¡æœ‰å·²å®Œæˆçš„æ„¿æœ›ã€‚</li>
                {% endfor %}
            </ul>
        </div>
        
    </div>
{% endblock %}