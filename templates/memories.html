{% extends "base.html" %}
{% block content %}
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>ğŸ’– æˆ‘ä»¬çš„çºªå¿µå†Œ</h2>
        <a href="{{ url_for('add_memory') }}" class="btn">
            + æ·»åŠ æ–°å›å¿†
        </a>
    </div>
    
    <p>è¿™é‡Œä¼šæ˜¾ç¤ºæ‚¨å’Œæ‚¨ä¼´ä¾£å…±åŒæ·»åŠ çš„æ‰€æœ‰ç¾å¥½å›å¿†ã€‚</p>
    
    <!-- V3.1: çºªå¿µå†Œå¡ç‰‡ç½‘æ ¼ -->
    <div class="memories-grid" style="margin-top: 20px;">
        
        {% for memory in memories %}
            <!-- 
              æˆ‘ä»¬ç”¨ <a> æ ‡ç­¾åŒ…è£¹å¡ç‰‡, ä½¿å…¶å¯ä»¥ç‚¹å‡»
              å¡ç‰‡çš„ CSS æ ·å¼åœ¨ base.html ä¸­å®šä¹‰
            -->
            <a href="{{ url_for('memory_detail', memory_id=memory.id) }}" class="memory-card">
                <img src="{{ url_for('static', filename='uploads/' + memory.image_file) }}" alt="{{ memory.title }}">
                <div class="memory-card-content">
                    <h3>{{ memory.title }}</h3>
                    <div class="memory-card-meta">
                        <!-- 
                          å¦‚æœ memory_date (æ—¥æœŸ) å­˜åœ¨, æ ¼å¼åŒ–å®ƒ
                          strftime('%Yå¹´%mæœˆ%dæ—¥')
                        -->
                        {% if memory.memory_date %}
                            <span>{{ memory.memory_date.strftime('%Yå¹´%mæœˆ%dæ—¥') }}</span>
                        {% endif %}
                        {% if memory.location %}
                            <span>Â· {{ memory.location }}</span>
                        {% endif %}
                    </div>
                    <div class="memory-card-author">
                        (ç”± 
                        {% if memory.author_id == current_user.id %}
                            <strong style="color: #007BFF;">æˆ‘</strong>
                        {% else %}
                            <strong style="color: #28a745;">{{ memory.author.username }}</strong>
                        {% endif %}
                        æ·»åŠ )
                    </div>
                </div>
            </a>
        {% else %}
            <p>æ‚¨ä»¬è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•å›å¿†ã€‚ <a href="{{ url_for('add_memory') }}">é©¬ä¸Šå»æ·»åŠ ç¬¬ä¸€ä¸ªï¼</a></p>
        {% endfor %}
        
    </div>
{% endblock %}