{% extends "base.html" %}
{% block content %}
    <div class="max-w-2xl mx-auto">
        <div class="text-center mb-8">
            <span class="inline-block bg-rose-100 text-rose-600 px-3 py-1 rounded-full text-sm font-bold mb-2">
                ğŸ“… æ¯æ—¥ä¸€é—® Â· {{ question.date_str }}
            </span>
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800">{{ question.content }}</h2>
        </div>

        <div class="grid gap-6">
            
            <!-- æˆ‘çš„å›ç­” -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-blue-500">
                <h3 class="font-bold text-gray-500 mb-2 flex items-center">
                    <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                    æˆ‘çš„å›ç­”
                </h3>
                
                {% if my_answer %}
                    <p class="text-lg text-gray-800">{{ my_answer.content }}</p>
                    <button onclick="document.getElementById('edit-form').style.display='block'" class="text-sm text-blue-500 mt-2 hover:underline">ä¿®æ”¹å›ç­”</button>
                {% else %}
                    <form action="{{ url_for('answer_daily_question', question_id=question.id) }}" method="POST">
                        <textarea name="content" rows="3" class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-blue-300" placeholder="å†™ä¸‹ä½ çš„æƒ³æ³•..."></textarea>
                        <button type="submit" class="btn mt-2 w-full">æäº¤å›ç­”</button>
                    </form>
                {% endif %}
                
                <!-- ä¿®æ”¹è¡¨å• (éšè—) -->
                {% if my_answer %}
                <form id="edit-form" action="{{ url_for('answer_daily_question', question_id=question.id) }}" method="POST" style="display:none;" class="mt-4">
                    <textarea name="content" rows="3" class="w-full border rounded-lg p-3">{{ my_answer.content }}</textarea>
                    <button type="submit" class="btn mt-2">ä¿å­˜ä¿®æ”¹</button>
                </form>
                {% endif %}
            </div>

            <!-- ä¼´ä¾£çš„å›ç­” -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-rose-500 relative overflow-hidden">
                <h3 class="font-bold text-gray-500 mb-2 flex items-center">
                    <span class="w-2 h-2 bg-rose-500 rounded-full mr-2"></span>
                    {{ partner_name }} çš„å›ç­”
                </h3>

                {% if is_unlocked %}
                    <!-- çŠ¶æ€ A: å·²è§£é” -->
                    <p class="text-lg text-gray-800">{{ partner_answer.content }}</p>
                    <div class="mt-4 p-3 bg-yellow-50 text-yellow-800 rounded-lg text-sm text-center">
                        ğŸ‰ åŒæ–¹å·²å®Œæˆï¼Œç­”æ¡ˆå·²è§£é”ï¼å¿«å»å’ŒTAè®¨è®ºä¸€ä¸‹å§ï¼
                    </div>
                {% else %}
                    <!-- çŠ¶æ€ B: æœªè§£é” -->
                    <div class="filter blur-sm select-none">
                        <p class="text-lg text-gray-400">
                            è¿™é‡Œæ˜¯å¯¹æ–¹çš„å›ç­”å†…å®¹ï¼Œä½†æ˜¯ä½ çœ‹ä¸åˆ°ã€‚
                            è¿™é‡Œæ˜¯å¯¹æ–¹çš„å›ç­”å†…å®¹ï¼Œä½†æ˜¯ä½ çœ‹ä¸åˆ°ã€‚
                        </p>
                    </div>
                    
                    <div class="absolute inset-0 flex items-center justify-center bg-white bg-opacity-60">
                        <div class="text-center p-4 bg-white shadow-xl rounded-xl border border-rose-100">
                            <div class="text-4xl mb-2">ğŸ”’</div>
                            {% if partner_answer %}
                                <p class="font-bold text-rose-600">TA å·²ç»å›ç­”å•¦ï¼</p>
                                <p class="text-sm text-gray-500">å¿«æäº¤ä½ çš„å›ç­”æ¥è§£é”ã€‚</p>
                            {% else %}
                                <p class="font-bold text-gray-500">TA è¿˜æ²¡æœ‰å›ç­”</p>
                                <p class="text-sm text-gray-400">ç­‰TAå›ç­”åæ‰èƒ½çœ‹åˆ°å“¦</p>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            </div>

        </div>
    </div>
{% endblock %}
```

#### ç¬¬3æ­¥ï¼šä¿®æ”¹ `templates/base.html` (æ·»åŠ å¯¼èˆª)

è¯·åœ¨ `base.html` çš„å¯¼èˆªæ ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„é“¾æ¥ï¼š

```html
<!-- åœ¨æ„¿æœ›æ¸…å•ä¸‹æ–¹ -->
<li><a href="{{ url_for('daily_question') }}" class="nav-link {{ 'active' if request.endpoint.startswith('daily_question') else '' }}">
    <i data-lucide="message-circle-question" class="w-4 h-4 sm:mr-2"></i>
    <span class="hidden sm:inline">æ¯æ—¥ä¸€é—®</span>
</a></li>
```

---

### ã€é˜¶æ®µäºŒ (V5.0)ï¼šæœ¬åœ°æµ‹è¯•ã€‘

1.  **æ¸…ç†æœ¬åœ°ç¯å¢ƒ**ï¼šåœæ­¢æœåŠ¡ï¼Œåˆ é™¤ `recipes.db` å’Œ `migrations` æ–‡ä»¶å¤¹ã€‚
2.  **åˆå§‹åŒ–æ•°æ®åº“**ï¼š
    ```powershell
    # æ¿€æ´»venv
    $env:FLASK_APP = "app.py"
    flask db init
    flask db migrate -m "V5.0 Add Daily Question"
    flask db upgrade
    ```
3.  **è¿è¡Œåº”ç”¨**ï¼š`python app.py`
4.  **æµ‹è¯•æµç¨‹**ï¼š
    * æ³¨å†Œ `test1`, `test2` å¹¶äº’ç›¸ç»‘å®šã€‚
    * `test1` è¿›å…¥â€œæ¯æ—¥ä¸€é—®â€ï¼Œæäº¤å›ç­”ã€‚
    * éªŒè¯ï¼š`test1` çœ‹ä¸åˆ° `test2` çš„ç­”æ¡ˆï¼ˆæ˜¾ç¤ºâ€œTAè¿˜æ²¡æœ‰å›ç­”â€ï¼‰ã€‚
    * `test2` è¿›å…¥â€œæ¯æ—¥ä¸€é—®â€ã€‚
    * éªŒè¯ï¼š`test2` çœ‹åˆ° `test1` â€œå·²ç»å›ç­”â€ï¼Œä½†å†…å®¹è¢«æ¨¡ç³Šé”å®šã€‚
    * `test2` æäº¤å›ç­”ã€‚
    * **å…³é”®éªŒè¯**ï¼šåŒæ–¹é¡µé¢åˆ·æ–°åï¼Œé”è§£å¼€ï¼Œèƒ½çœ‹åˆ°å½¼æ­¤çš„çœŸå¿ƒè¯ï¼

---

### ã€é˜¶æ®µä¸‰ (V5.0)ï¼šæœåŠ¡å™¨éƒ¨ç½² (æ‰‹åŠ¨æ‰‹æœ¯)ã€‘

å½“æœ¬åœ°æµ‹è¯•é€šè¿‡åï¼Œæ‚¨å¯ä»¥æ¨é€åˆ°æœåŠ¡å™¨ã€‚

**æœåŠ¡å™¨ç«¯æ‰‹åŠ¨å‡çº§æ•°æ®åº“å‘½ä»¤ï¼ˆè¯·åœ¨ `systemctl stop` åè¿è¡Œï¼‰ï¼š**

```bash
# 1. åˆ›å»º DailyQuestion è¡¨
sqlite3 recipes.db "CREATE TABLE daily_question (id INTEGER NOT NULL, content VARCHAR(200) NOT NULL, date_str VARCHAR(10) NOT NULL, PRIMARY KEY (id), UNIQUE (date_str));"

# 2. åˆ›å»º DailyAnswer è¡¨
sqlite3 recipes.db "CREATE TABLE daily_answer (id INTEGER NOT NULL, content TEXT NOT NULL, user_id INTEGER NOT NULL, question_id INTEGER NOT NULL, PRIMARY KEY (id), FOREIGN KEY(user_id) REFERENCES user (id), FOREIGN KEY(question_id) REFERENCES daily_question (id));"