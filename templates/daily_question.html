{% extends "base.html" %}
{% block content %}
    <div class="max-w-2xl mx-auto">
        
        <!-- é¡¶éƒ¨å¯¼èˆªæ ï¼šå·¦è¾¹æ˜¯è¿”å›ï¼Œå³è¾¹å°±æ˜¯ã€å†å²å›é¡¾ã€‘å…¥å£ -->
        <div class="flex justify-between items-center mb-6">
            <a href="{{ url_for('index') }}" class="text-gray-500 hover:text-gray-700 flex items-center">
                <i data-lucide="arrow-left" class="w-4 h-4 mr-1"></i> è¿”å›é¦–é¡µ
            </a>
            
            <!-- ï¼ï¼ï¼å…¥å£åœ¨è¿™é‡Œï¼ï¼ï¼ -->
            <a href="{{ url_for('daily_history') }}" class="text-rose-500 hover:text-rose-700 font-semibold flex items-center">
                <i data-lucide="history" class="w-4 h-4 mr-1"></i> å†å²å›é¡¾
            </a>
        </div>

        <div class="text-center mb-8">
            <!-- æ¥æºå’Œæ—¥æœŸæ ‡ç­¾ -->
            <div class="flex justify-center gap-2 mb-3">
                <span class="inline-block bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-bold">
                    ğŸ“… {{ question.date_str }}
                </span>
                <!-- æ ¹æ®æ¥æºæ˜¾ç¤ºä¸åŒé¢œè‰² -->
                <span class="inline-block px-3 py-1 rounded-full text-xs font-bold
                    {% if 'AI' in question.source %} bg-purple-100 text-purple-600 {% else %} bg-yellow-100 text-yellow-700 {% endif %}">
                    âœ¨ {{ question.source }}
                </span>
            </div>
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800">{{ question.content }}</h2>
        </div>

        <div class="grid gap-6">
            
            <!-- æˆ‘çš„å›ç­” -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-blue-500">
                <h3 class="font-bold text-gray-500 mb-2 flex items-center">
                    <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                    æˆ‘çš„å›ç­”
                </h3>
                
                {% if my_answer %}
                    <p class="text-lg text-gray-800">{{ my_answer.content }}</p>
                    <button onclick="document.getElementById('edit-form').style.display='block'" class="text-sm text-blue-500 mt-2 hover:underline">ä¿®æ”¹å›ç­”</button>
                {% else %}
                    <form action="{{ url_for('answer_daily_question', question_id=question.id) }}" method="POST">
                        <textarea name="content" rows="3" class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-blue-300" placeholder="å†™ä¸‹ä½ çš„æƒ³æ³•..." required></textarea>
                        <button type="submit" class="btn mt-2 w-full">æäº¤å›ç­”</button>
                    </form>
                {% endif %}
                
                <!-- ä¿®æ”¹è¡¨å• (é»˜è®¤éšè—) -->
                {% if my_answer %}
                <form id="edit-form" action="{{ url_for('answer_daily_question', question_id=question.id) }}" method="POST" style="display:none;" class="mt-4">
                    <textarea name="content" rows="3" class="w-full border rounded-lg p-3">{{ my_answer.content }}</textarea>
                    <button type="submit" class="btn mt-2">ä¿å­˜ä¿®æ”¹</button>
                </form>
                {% endif %}
            </div>

            <!-- ä¼´ä¾£çš„å›ç­” -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-rose-500 relative overflow-hidden">
                <h3 class="font-bold text-gray-500 mb-2 flex items-center">
                    <span class="w-2 h-2 bg-rose-500 rounded-full mr-2"></span>
                    {{ partner_name }} çš„å›ç­”
                </h3>

                {% if is_unlocked %}
                    <!-- çŠ¶æ€ A: å·²è§£é” -->
                    <p class="text-lg text-gray-800">{{ partner_answer.content }}</p>
                    <div class="mt-4 p-3 bg-yellow-50 text-yellow-800 rounded-lg text-sm text-center">
                        ğŸ‰ åŒæ–¹å·²å®Œæˆï¼Œç­”æ¡ˆå·²è§£é”ï¼å¿«å»å’ŒTAè®¨è®ºä¸€ä¸‹å§ï¼
                    </div>
                {% else %}
                    <!-- çŠ¶æ€ B: æœªè§£é” (æ¨¡ç³Šé®ç½©) -->
                    <div class="filter blur-sm select-none">
                        <p class="text-lg text-gray-400">
                            è¿™é‡Œæ˜¯å¯¹æ–¹çš„å›ç­”å†…å®¹ï¼Œä½†æ˜¯ä½ çœ‹ä¸åˆ°ã€‚
                            è¿™é‡Œæ˜¯å¯¹æ–¹çš„å›ç­”å†…å®¹ï¼Œä½†æ˜¯ä½ çœ‹ä¸åˆ°ã€‚
                        </p>
                    </div>
                    
                    <div class="absolute inset-0 flex items-center justify-center bg-white bg-opacity-60">
                        <div class="text-center p-4 bg-white shadow-xl rounded-xl border border-rose-100">
                            <div class="text-4xl mb-2">ğŸ”’</div>
                            {% if partner_answer %}
                                <p class="font-bold text-rose-600">TA å·²ç»å›ç­”å•¦ï¼</p>
                                <p class="text-sm text-gray-500">å¿«æäº¤ä½ çš„å›ç­”æ¥è§£é”ã€‚</p>
                            {% else %}
                                <p class="font-bold text-gray-500">TA è¿˜æ²¡æœ‰å›ç­”</p>
                                <p class="text-sm text-gray-400">ç­‰TAå›ç­”åæ‰èƒ½çœ‹åˆ°å“¦</p>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            </div>

        </div>
    </div>
    <!-- æ¿€æ´»å›¾æ ‡ -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') lucide.createIcons();
        });
    </script>
{% endblock %}